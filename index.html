<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>H • Portfolio</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <header>
    <h1>H</h1>
    <p>Cloud & Full-Stack • AWS • React • Flutter</p>
    <nav>
      <a href="https://github.com/Hasanm-01">GitHub</a>
      <a href="www.linkedin.com/in/hasan-malik-299554190">LinkedIn</a>
      <a href="mailto:Hasan_1001@live.com">Email</a>
    </nav>
  </header>

  <section id="projects"><h2>Projects</h2><div id="grid"></div></section>
  <footer><small>© 2025 H • Built with GitHub Pages</small></footer>

  <script>
  const username = "Hasanm-01";
  const pinned = [
    "serverless-task-tracker",
    "task-tracker-web",
    // add "data-dashboard-flask" after you create it,
    // or keep it here if you want a link placeholder
  ];

  const grid = document.getElementById("grid");

  const addCard = (r, topics = []) => {
    const a = document.createElement("a");
    a.className = "card";
    a.href = r.homepage || r.html_url || `https://github.com/${username}/${r.name}`;
    a.target = "_blank";
    a.rel = "noopener";
    a.innerHTML = `
      <h3>${r.name}</h3>
      <p>${r.description ?? ""}</p>
      <div class="meta">
        <span>★ ${r.stargazers_count ?? 0}</span>
        <span>${r.language ?? "—"}</span>
      </div>
      <div class="topics">${(topics||[]).slice(0,5).map(t=>`<span>${t}</span>`).join("")}</div>
    `;
    grid.appendChild(a);
  };

  async function load() {
    try {
      const res = await fetch(`https://api.github.com/users/${username}/repos?per_page=100`, {
        headers: { "Accept": "application/vnd.github+json" }
      });
      let repos = await res.json();
      if (!Array.isArray(repos)) throw new Error((repos && repos.message) || "Unexpected response");

      repos = repos.filter(r => !r.fork && !r.archived);
      const map = new Map(repos.map(r => [r.name, r]));
      const ordered = pinned.map(n => map.get(n)).filter(Boolean);

      for (const r of ordered.slice(0, 12)) {
        let topics = [];
        try {
          const t = await fetch(`https://api.github.com/repos/${username}/${r.name}/topics`, {
            headers: { "Accept": "application/vnd.github+json" }
          }).then(x => x.json());
          topics = (t && t.names) ? t.names : [];
        } catch {}
        addCard(r, topics);
      }

      // If nothing rendered (rate limit / error / names mismatch), show fallback links
      if (grid.children.length === 0) {
        pinned.forEach(name => addCard({ name, html_url: `https://github.com/${username}/${name}` }));
      }
    } catch (e) {
      // Full fallback
      pinned.forEach(name => addCard({ name, html_url: `https://github.com/${username}/${name}` }));
      console.warn("GitHub API failed, showing fallback cards:", e);
    }
  }

  load();
</script>

</body>
</html>
